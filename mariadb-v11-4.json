{
    "_comment": "DO NOT EDIT: FILE GENERATED AUTOMATICALLY BY PTERODACTYL PANEL - PTERODACTYL.IO",
    "meta": {
        "version": "PTDL_v2",
        "update_url": null
    },
    "exported_at": "2023-12-19T09:54:17+01:00",
    "name": "MariaDB 11.4",
    "author": "parker@parkervcp.com",
    "description": "One of the most popular database servers. Made by the original developers of MySQL. Guaranteed to stay open source.",
    "features": null,
    "docker_images": {
        "MariaDB 11.4": "docker pull ghcr.io/parkervcp/yolks:mariadb_11.4"
    },
    "file_denylist": [],
    "startup": "{ /usr/bin/mysqld_safe & } && sleep 5 && mysql -u root",
    "config": {
        "files": {
            ".my.cnf": {
                "parser": "file",
                "find": {
                    "port": "port = {{server.build.default.port}}",
                    "bind-address": "bind-address=0.0.0.0"
                }
            }
        },
        "startup": {
            "done": "mysqld: ready for connections"
        },
        "logs": {},
        "stop": "shutdown; exit;"
    },
    "scripts": {
        "installation": {
            "script": "#!/bin/bash\n# MariaDB Installation Script\n#\n# Server Files: /mnt/server\nset -x\n\n# Update and install dependencies\necho -e \"Installing dependencies\"\napt-get -y update\napt-get -y install curl mariadb-server mariadb-client\n\n# Add container user\necho -e \"Adding container user\"\nuseradd -d /home/container -m container -s /bin/bash\n\n# Change ownership of server files to container user\nchown container: /mnt/server/\n\n# Fetching and configuring my.cnf\nif [ -f /mnt/server/.my.cnf ]; then\n    echo -e \"Moving current config for install\"\n    mv /mnt/server/.my.cnf /mnt/server/custom.my.cnf\n    runuser -l container -c 'curl https://raw.githubusercontent.com/parkervcp/eggs/master/database/sql/mariadb/install.my.cnf > /mnt/server/.my.cnf'\nelse\n    runuser -l container -c 'curl https://raw.githubusercontent.com/parkervcp/eggs/master/database/sql/mariadb/install.my.cnf > /mnt/server/.my.cnf'\nfi\n\n# Creating necessary directories\necho -e \"Creating directories for MariaDB\"\nrunuser -l container -c 'mkdir -p /mnt/server/run/mysqld'\nrunuser -l container -c 'mkdir -p /mnt/server/log/mysql'\nrunuser -l container -c 'mkdir /mnt/server/mysql'\n\n# Initialize the MariaDB database\necho -e \"Initializing the MariaDB database\"\nrunuser -l container -c 'mysql_install_db --defaults-file=/mnt/server/.my.cnf'\n\n# Restore original config file if present\nif [ -f /mnt/server/custom.my.cnf ]; then\n    echo -e \"Restoring original config file\"\n    mv /mnt/server/custom.my.cnf /mnt/server/.my.cnf\nelse\n    curl https://raw.githubusercontent.com/parkervcp/eggs/master/database/sql/mariadb/my.cnf > /mnt/server/.my.cnf\nfi\n\necho -e \"Installation complete\"\nexit",
            "container": "mariadb:11.4",
            "entrypoint": "bash"
        }
    },
    "variables": []
}
